#!/usr/bin/env bash
# Stop hook: remind Claude to complete followup work before stopping

set -euo pipefail

# Read the hook input from stdin
INPUT=$(cat)
STOP_HOOK_ACTIVE=$(echo "$INPUT" | jq -r '.stop_hook_active // false')

# If the hook has already run this session, allow stop
if [[ "$STOP_HOOK_ACTIVE" == "true" ]]; then
  exit 0
fi

# Remind Claude to do followup work
cat >&2 <<'EOF'
Do you need to add, change, or remove any tests, documentation, plans, code comments, justfile recipes, CLAUDE.md, or similar?
EOF

# Exit 2 blocks the stop and shows the message to Claude
exit 2
